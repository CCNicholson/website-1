---
title: "Statistical Analysis using R"
author: "Robin Donatello"
date: 'Last Updated `r Sys.time()`'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(gridExtra)

cdc <- read.table("~/GitHub/DSI/materials/cdc.txt", header=TRUE, sep="\t")
```

Create the difference between weight and desired weight. 

```{r}
cdc$wtdiff <- cdc$wtdesire - cdc$weight
```

are people happy with their weight? 
```{r}
summary(cdc$wtdiff)
ggplot(cdc, aes(x=wtdiff)) + geom_histogram() + theme_bw()
```

Remove records for people who say they want to add more than 300 lbs
```{r}
cdc <- subset(cdc, wtdiff < 200)
```

```{r}
t.test(cdc$wtdiff, mu=0, alternative="two.sided", conf.level = .95)
```

proportion test for equal proportions
```{r}
prop.test(x=9440, 
          n=19998, 
          p=.5)
```

Does the average weight difference differ between males and females? 

```{r}
t.test(wtdiff~gender, data=cdc)
# model notation -- y ~ x1 + x2 + .. 
```

# anova for difference in means across multiple groups

```{r}
model <- aov(wtdesire~genhlth, data=cdc)
summary(model)
```


```{r}
smoke.by.gender <- table(cdc$smoke100, cdc$gender)
chisq.test(smoke.by.gender)
```

exclude reports for weight > 250
```{r}
lt250 <- subset(cdc, weight<=250)

linear.model <- lm(wtdesire ~ weight + gender + weight*gender, data=lt250)
summary(linear.model)

qqnorm(linear.model$residuals)
qqline(linear.model$residuals, col="red")
```

change variable names to all upper case
```{r}
names(cdc) <- tolower(names(cdc))
````
